# Dataverseæ¥ç¶š å®Œå…¨ã‚¬ã‚¤ãƒ‰

**æœ€çµ‚æ›´æ–°**: 2026å¹´2æœˆ5æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**å¯¾è±¡Phase**: Phase 3ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆï¼‰

---

## ğŸ“‹ ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ã€Power Apps Code Appsã§Dataverseã«æ¥ç¶šã—ã€ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿æ›¸ãã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®**å®Œå…¨ã‹ã¤æœ€çµ‚ç‰ˆ**ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã™ã€‚ã“ã‚Œã¾ã§ã®é–‹ç™ºçŸ¥è¦‹ã‚’çµ±åˆã—ã€å¯èª­æ€§ã¨å†ç¾æ€§ã‚’æœ€å¤§é™ã«é«˜ã‚ã¦ã„ã¾ã™ã€‚

### å¯¾è±¡èª­è€…

- Power Apps Code Appsã§åˆã‚ã¦Dataverseã«æ¥ç¶šã™ã‚‹é–‹ç™ºè€…
- Dataverseæ¥ç¶šã§ã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ãŸé–‹ç™ºè€…
- ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«åŸºã¥ã„ãŸå®Ÿè£…ã‚’è¡Œã„ãŸã„é–‹ç™ºè€…

### ã“ã®ã‚¬ã‚¤ãƒ‰ã§å­¦ã¹ã‚‹ã“ã¨

âœ… Dataverseã¸ã®æ­£ã—ã„æ¥ç¶šæ–¹æ³•  
âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ã®æ¨™æº–æ‰‹é †  
âœ… Power Apps SDKã‚’ä½¿ç”¨ã—ãŸCRUDæ“ä½œ  
âœ… ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨ãã®è§£æ±ºæ–¹æ³•  
âœ… å®Ÿè·µçš„ãªå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

---

## ğŸ¯ å‰ææ¡ä»¶

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å§‹ã‚ã‚‹å‰ã«ã€ä»¥ä¸‹ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- [ ] **Phase 0å®Œäº†**: é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆNode.jsã€Power Platform CLIï¼‰
- [ ] **Phase 1å®Œäº†**: Microsoftæ¨™æº–ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã€SDKåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼ãŒãªã„
- [ ] **Phase 2å®Œäº†**: å¿…è¦ãªæ©Ÿèƒ½ã®å®Ÿè£…ï¼ˆUIã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
- [ ] **Power Platformç’°å¢ƒ**: Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆæ¸ˆã¿
- [ ] **èªè¨¼è¨­å®š**: `# èªè¨¼ã¯CLIã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•çš„ã«é–‹ãã¾ã™ï¼ˆåˆ¥é€”å®Ÿè¡Œä¸è¦ï¼‰`ã§ç’°å¢ƒã«èªè¨¼æ¸ˆã¿

> **âš ï¸ é‡è¦**: Phase 3ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆï¼‰ã¯ã€Phase 1ã¨Phase 2ãŒå®Œäº†ã—ãŸ**æœ€å¾Œã®ã‚¹ãƒ†ãƒƒãƒ—**ã§ã™ã€‚åŸºç›¤ãŒå®‰å®šã—ã¦ã„ã‚‹çŠ¶æ…‹ã§å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ“š ç›®æ¬¡

1. [Dataverseæ¥ç¶šã®å…¨ä½“åƒ](#-dataverseæ¥ç¶šã®å…¨ä½“åƒ)
2. [Step 1: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ](#step-1-ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ )
3. [Step 2: ã‚¹ã‚­ãƒ¼ãƒç¢ºèª](#step-2-ã‚¹ã‚­ãƒ¼ãƒç¢ºèª)
4. [Step 3: Modelå®šç¾©](#step-3-modelå®šç¾©)
5. [Step 4: Serviceå®Ÿè£…](#step-4-serviceå®Ÿè£…)
6. [Step 5: UIã§ã®åˆ©ç”¨](#step-5-uiã§ã®åˆ©ç”¨)
7. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#-ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
8. [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#-ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
9. [ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#-å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)

---

## ğŸ—ï¸ Dataverseæ¥ç¶šã®å…¨ä½“åƒ

### æ¥ç¶šãƒ•ãƒ­ãƒ¼

```mermaid
graph TB
    A[Phase 1-2å®Œäº†] --> B[Dataverseãƒ†ãƒ¼ãƒ–ãƒ«æº–å‚™]
    B --> C[npx @microsoft/power-apps-cli add-data-sourceå®Ÿè¡Œ]
    C --> D[ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ç”Ÿæˆ]
    D --> E[Modelå®šç¾©ä½œæˆ]
    E --> F[Serviceå±¤å®Ÿè£…]
    F --> G[UIçµ±åˆ]
    G --> H[ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤]
    
    style A fill:#e3f2fd
    style C fill:#fff3e0
    style F fill:#e8f5e9
    style H fill:#f3e5f5
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | èª¬æ˜ |
|---------|------|------|
| **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹** | Microsoft Dataverse | Power Platformã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| **æ¥ç¶šæ–¹æ³•** | Power Apps SDK | `@microsoft/power-apps` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ |
| **ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆ** | Power Platform CLI | `npx @microsoft/power-apps-cli add-data-source` ã‚³ãƒãƒ³ãƒ‰ |
| **å‹å®šç¾©** | TypeScript | Modelå®šç¾©ã§å‹å®‰å…¨æ€§ã‚’ç¢ºä¿ |
| **ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹** | Serviceå±¤ | ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ã‚«ãƒ—ã‚»ãƒ«åŒ– |

---

## Step 1: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ 

### 1.1 ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åã‚’ç¢ºèª

Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã®**è«–ç†åï¼ˆLogicalNameï¼‰**ã‚’ç¢ºèªã—ã¾ã™ã€‚

**ç¢ºèªæ–¹æ³•â‘ : Power Apps Maker Portal**
1. https://make.powerapps.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **ãƒ†ãƒ¼ãƒ–ãƒ«** â†’ å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠ
3. **è¨­å®š** â†’ **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£** â†’ **åå‰**æ¬„ã‚’ç¢ºèª

**ç¢ºèªæ–¹æ³•â‘¡: Power Apps Maker Portal**
```bash
# ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†åã¯https://make.powerapps.com ã®ãƒ†ãƒ¼ãƒ–ãƒ«è¨­å®šã‹ã‚‰ç¢ºèªã§ãã¾ã™
# ï¼ˆç’°å¢ƒã®é¸æŠã¯ npx @microsoft/power-apps-cli init --environmentId [id] ã§è¡Œã„ã¾ã™ï¼‰
```

**ä¾‹:**
- ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«: `geek_businessprocess`, `geek_project`, `geek_task`
- æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ«: `account`, `contact`, `systemuser`

> **ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ**: è«–ç†åã¯**å˜æ•°å½¢**ã§ã™ï¼ˆä¾‹: `geek_project`ã€è¤‡æ•°å½¢ã® `geek_projects` ã§ã¯ãªã„ï¼‰

---

### 1.2 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ 

Power Platform CLIã‚’ä½¿ç”¨ã—ã¦Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚

#### âœ… æ­£ã—ã„ã‚³ãƒãƒ³ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

```bash
npx @microsoft/power-apps-cli add-data-source -a dataverse -t <ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å>
```

**å…·ä½“ä¾‹:**
```bash
# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
npx @microsoft/power-apps-cli add-data-source -a dataverse -t geek_businessprocess

# æ¨™æº–ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ 
npx @microsoft/power-apps-cli add-data-source -a dataverse -t account
```

#### ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®èª¬æ˜

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | å¿…é ˆ |
|-----------|------|------|
| `-a dataverse` | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã‚’Dataverseã«æŒ‡å®š | âœ… å¿…é ˆ |
| `-t <è«–ç†å>` | ãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†åï¼ˆå˜æ•°å½¢ï¼‰ | âœ… å¿…é ˆ |
| `-c <æ¥ç¶šID>` | æ¥ç¶šID | âŒ ä¸è¦ï¼ˆè‡ªå‹•å–å¾—ï¼‰ |
| `-d <ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ>` | ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå | âŒ ä¸è¦ï¼ˆè‡ªå‹•è¨­å®šï¼‰ |

> **âš ï¸ é‡è¦**: `-a`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯å¿…ãš `dataverse` ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚`shared_commondataserviceforapps` ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

---

#### âŒ é¿ã‘ã‚‹ã¹ãæ–¹æ³•

```bash
# âŒ é–“é•ã„: shared_commondataserviceforapps ã‚’ä½¿ç”¨
npx @microsoft/power-apps-cli add-data-source -a "shared_commondataserviceforapps" -c "<Connection-ID>"
```

**å•é¡Œç‚¹:**
- `The interface 'CDPTabular1' was not found` ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
- ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œãªã„
- æ‰‹å‹•è¨­å®šãŒå¿…è¦ã«ãªã‚Šè¤‡é›‘åŒ–

---

### 1.3 ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

`npx @microsoft/power-apps-cli add-data-source`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ï¼š

```
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ/
â”œâ”€â”€ .power/
â”‚   â””â”€â”€ schemas/
â”‚       â”œâ”€â”€ dataverse/
â”‚       â”‚   â””â”€â”€ geekbusinessprocesses.Schema.json  â† æ–°è¦ç”Ÿæˆ
â”‚       â””â”€â”€ appschemas/
â”‚           â””â”€â”€ dataSourcesInfo.ts  â† æ›´æ–°
â””â”€â”€ power.config.json  â† æ›´æ–°
```

#### 1.3.1 ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.power/schemas/dataverse/`ï¼‰

ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©ã€å‹æƒ…å ±ãŒå«ã¾ã‚Œã¾ã™ã€‚

**ä¾‹: `geekbusinessprocesses.Schema.json`**
```json
{
  "type": "object",
  "properties": {
    "geek_businessprocessid": {
      "type": "string",
      "format": "uuid",
      "x-ms-dataverse-attribute": "geek_businessprocessid"
    },
    "geek_processname": {
      "type": "string",
      "x-ms-dataverse-attribute": "geek_processname"
    },
    "geek_description": {
      "type": "string",
      "x-ms-dataverse-attribute": "geek_description"
    }
  }
}
```

#### 1.3.2 dataSourcesInfo.ts

ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æƒ…å ±ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

**ä¾‹:**
```typescript
export const dataSourcesInfo = {
  "geekbusinessprocesses": {
    "tableId": "geekbusinessprocesses",
    "version": "",
    "primaryKey": "geek_businessprocessid",
    "dataSourceType": "Dataverse",
    "apis": {}
  }
};
```

> **ğŸ’¡ é‡è¦**: `tableId`ã®å€¤ï¼ˆä¾‹: `geekbusinessprocesses`ï¼‰ãŒServiceå®Ÿè£…ã§ä½¿ç”¨ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«åã«ãªã‚Šã¾ã™ã€‚

#### 1.3.3 power.config.json

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å‚ç…§ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

```json
{
  "databaseReferences": {
    "dataverse": {
      "type": "Dataverse"
    }
  },
  "dataSources": {
    "geekbusinessprocesses": {
      "tableId": "geekbusinessprocesses"
    }
  }
}
```

---

## Step 2: ã‚¹ã‚­ãƒ¼ãƒç¢ºèª

### 2.1 ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®ç¢ºèª

ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã‚’ç¢ºèªã—ã¾ã™ã€‚

**ç¢ºèªç®‡æ‰€:**
```
.power/schemas/dataverse/<ãƒ†ãƒ¼ãƒ–ãƒ«å>.Schema.json
```

**ç¢ºèªã™ã¹ããƒã‚¤ãƒ³ãƒˆ:**
- âœ… ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼ˆé€šå¸¸: `<ãƒ†ãƒ¼ãƒ–ãƒ«å>id`ï¼‰
- âœ… å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- âœ… é¸æŠè‚¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆChoice/Picklistï¼‰
- âœ… å‚ç…§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆLookupï¼‰
- âœ… æ—¥ä»˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

---

### 2.2 Choiceï¼ˆé¸æŠè‚¢ï¼‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ç¢ºèª

ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯Choiceå€¤ã®å®šç¾©ãŒå«ã¾ã‚Œã¦ã„ãªã„ãŸã‚ã€Power Apps Maker Portalã§ç¢ºèªã—ã¾ã™ã€‚

**ç¢ºèªæ‰‹é †:**
1. https://make.powerapps.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **ãƒ†ãƒ¼ãƒ–ãƒ«** â†’ å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ« â†’ **åˆ—**
3. Choiceåˆ—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ã‚’ç¢ºèª

**ä¾‹: geek_priorityï¼ˆå„ªå…ˆåº¦ï¼‰**
| å€¤ | è¡¨ç¤ºå |
|----|--------|
| 0  | Critical |
| 1  | High |
| 2  | Medium |
| 3  | Low |

> **ğŸ’¡ æ¨å¥¨**: Choiceå€¤ã¯`DATAVERSE_SCHEMA_REFERENCE.md`ã«è¨˜éŒ²ã—ã¦ãŠãã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---

### 2.3 Lookupï¼ˆå‚ç…§ï¼‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç¢ºèª

Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®å‚ç…§ã§ã™ã€‚

**ã‚¹ã‚­ãƒ¼ãƒã§ã®è¡¨ç¤º:**
```json
{
  "geek_projectid": {
    "type": "string",
    "format": "uuid",
    "x-ms-dataverse-type": "LookupType",
    "x-ms-dataverse-lookup-entity": "geek_project"
  }
}
```

**é‡è¦ãªæƒ…å ±:**
- `geek_projectid`: Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼ˆGUIDï¼‰
- `geek_project`: å‚ç…§å…ˆãƒ†ãƒ¼ãƒ–ãƒ«ã®è«–ç†å

---

## Step 3: Modelå®šç¾©

### 3.1 åŸºæœ¬Modelå®šç¾©

TypeScriptã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§Dataverseãƒ†ãƒ¼ãƒ–ãƒ«ã®å‹ã‚’å®šç¾©ã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®:**
```
src/
â””â”€â”€ Models/
    â””â”€â”€ GeekBusinessProcessModel.ts
```

**åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³:**
```typescript
/**
 * Dataverseãƒ†ãƒ¼ãƒ–ãƒ«: geek_businessprocess
 * è«–ç†å: geek_businessprocess
 * EntitySetName: geekbusinessprocesses
 */

// ãƒ‡ãƒ¼ã‚¿å–å¾—æ™‚ã®å‹
export interface GeekBusinessProcess {
  // ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼
  geek_businessprocessid?: string;
  
  // ãƒ—ãƒ©ã‚¤ãƒãƒªãƒãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  geek_processname: string;
  
  // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  geek_processid?: string;       // Auto Number
  geek_description?: string;     // è¤‡æ•°è¡Œãƒ†ã‚­ã‚¹ãƒˆ
  geek_markdowndetails?: string; // è¤‡æ•°è¡Œãƒ†ã‚­ã‚¹ãƒˆ
  
  // ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  createdon?: string;   // ä½œæˆæ—¥æ™‚
  modifiedon?: string;  // æ›´æ–°æ—¥æ™‚
  statecode?: number;   // çŠ¶æ…‹ã‚³ãƒ¼ãƒ‰ (0: Active, 1: Inactive)
  statuscode?: number;  // çŠ¶æ…‹ç†ç”±
  ownerid?: string;     // æ‰€æœ‰è€…
}

// æ–°è¦ä½œæˆç”¨ã®å‹ï¼ˆå¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ï¼‰
export interface GeekBusinessProcessCreateInput {
  geek_processname: string; // å¿…é ˆ
  geek_description?: string;
  geek_markdowndetails?: string;
}

// æ›´æ–°ç”¨ã®å‹ï¼ˆã™ã¹ã¦ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰
export interface GeekBusinessProcessUpdateInput {
  geek_processname?: string;
  geek_description?: string;
  geek_markdowndetails?: string;
}
```

---

### 3.2 Choiceå€¤ã®ãƒãƒƒãƒ”ãƒ³ã‚°

Choiceï¼ˆé¸æŠè‚¢ï¼‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å®šæ•°ã§å®šç¾©ã—ã¾ã™ã€‚

```typescript
// å„ªå…ˆåº¦ (geek_priority)
export const Priority = {
  Critical: 0,
  High: 1,
  Medium: 2,
  Low: 3
} as const;

export type PriorityValue = typeof Priority[keyof typeof Priority];

// ä½¿ç”¨ä¾‹
export interface GeekTask {
  geek_taskid?: string;
  geek_taskname: string;
  geek_priority?: PriorityValue; // 0 | 1 | 2 | 3
}
```

---

### 3.3 Lookupå€¤ã®æ‰±ã„

Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯é€šå¸¸GUIDã®æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚

```typescript
export interface GeekTask {
  geek_taskid?: string;
  geek_taskname: string;
  
  // Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç…§ï¼‰
  _geek_projectid_value?: string; // GUIDï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
  geek_projectid?: string;        // GUIDï¼ˆæ›¸ãè¾¼ã¿ç”¨ï¼‰
  
  // $expand ã§å–å¾—ã—ãŸå ´åˆã®å±•é–‹ãƒ‡ãƒ¼ã‚¿
  geek_projectid_expanded?: {
    geek_projectid: string;
    geek_projectname: string;
  };
}
```

> **ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ**: 
> - èª­ã¿å–ã‚Šæ™‚: `_<ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å>_value`ï¼ˆã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§å›²ã¾ã‚ŒãŸå½¢å¼ï¼‰
> - æ›¸ãè¾¼ã¿æ™‚: `<ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å>`ï¼ˆé€šå¸¸ã®å½¢å¼ï¼‰
> - å±•é–‹æ™‚: `<ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å>_expanded`ï¼ˆã‚«ã‚¹ã‚¿ãƒ å®šç¾©ï¼‰

---

## Step 4: Serviceå®Ÿè£…

### 4.1 åŸºæœ¬Serviceæ§‹é€ 

ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’Serviceå±¤ã«å®Ÿè£…ã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®:**
```
src/
â””â”€â”€ Services/
    â””â”€â”€ GeekBusinessProcessService.ts
```

**åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³:**
```typescript
import { getClient, type DataClient } from '@microsoft/power-apps/data';
import type { IOperationOptions, IOperationResult } from '@microsoft/power-apps/data';
import { dataSourcesInfo } from '../../.power/schemas/appschemas/dataSourcesInfo';
import type { 
  GeekBusinessProcess, 
  GeekBusinessProcessCreateInput, 
  GeekBusinessProcessUpdateInput 
} from '@/Models/GeekBusinessProcessModel';

// ãƒ†ãƒ¼ãƒ–ãƒ«åï¼ˆdataSourcesInfo ã® tableId ã«ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰
const TABLE_NAME = 'geekbusinessprocesses';

/**
 * DataClient ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—
 */
const getDataClient = (): DataClient => {
  return getClient(dataSourcesInfo);
};

/**
 * ä¸€è¦§å–å¾—
 */
export async function fetchBusinessProcesses(): Promise<GeekBusinessProcess[]> {
  const client = getDataClient();
  
  const options: IOperationOptions = {
    select: [
      'geek_businessprocessid',
      'geek_processname',
      'geek_processid',
      'geek_description',
      'geek_markdowndetails',
      'createdon',
      'modifiedon'
    ],
    orderBy: ['modifiedon desc'],
    filter: 'statecode eq 0', // Activeã®ã¿
  };

  const result: IOperationResult<GeekBusinessProcess[]> = 
    await client.retrieveMultipleRecordsAsync<GeekBusinessProcess>(
      TABLE_NAME,
      options
    );

  // ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
  if (!result.success) {
    console.error('Fetch error:', result.error);
    throw new Error(`ãƒ‡ãƒ¼ã‚¿å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
  }

  return result.data || [];
}

/**
 * 1ä»¶å–å¾—
 */
export async function fetchBusinessProcessById(
  id: string
): Promise<GeekBusinessProcess | null> {
  const client = getDataClient();
  
  const options: IOperationOptions = {
    select: [
      'geek_businessprocessid',
      'geek_processname',
      'geek_description',
      'geek_markdowndetails'
    ]
  };

  const result: IOperationResult<GeekBusinessProcess> = 
    await client.retrieveRecordAsync<GeekBusinessProcess>(
      TABLE_NAME,
      id,
      options
    );

  if (!result.success) {
    console.error('Fetch by ID error:', result.error);
    return null;
  }

  return result.data;
}

/**
 * æ–°è¦ä½œæˆ
 */
export async function createBusinessProcess(
  input: GeekBusinessProcessCreateInput
): Promise<string> {
  const client = getDataClient();
  
  const result: IOperationResult<string> = 
    await client.createRecordAsync(TABLE_NAME, input);

  if (!result.success) {
    console.error('Create error:', result.error);
    throw new Error(`ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
  }

  return result.data; // æ–°è¦ä½œæˆã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®GUID
}

/**
 * æ›´æ–°
 */
export async function updateBusinessProcess(
  id: string,
  input: GeekBusinessProcessUpdateInput
): Promise<void> {
  const client = getDataClient();
  
  const result = await client.updateRecordAsync(TABLE_NAME, id, input);

  if (!result.success) {
    console.error('Update error:', result.error);
    throw new Error(`æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
  }
}

/**
 * å‰Šé™¤ï¼ˆè«–ç†å‰Šé™¤ï¼‰
 */
export async function deleteBusinessProcess(id: string): Promise<void> {
  const client = getDataClient();
  
  const result = await client.deleteRecordAsync(TABLE_NAME, id);

  if (!result.success) {
    console.error('Delete error:', result.error);
    throw new Error(`å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
  }
}
```

---

### 4.2 ODataã‚¯ã‚¨ãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³

Power Apps SDKã¯ OData ã‚¯ã‚¨ãƒªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

#### selectï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é¸æŠï¼‰
```typescript
const options: IOperationOptions = {
  select: ['geek_projectid', 'geek_projectname', 'createdon']
};
```

#### filterï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰
```typescript
const options: IOperationOptions = {
  // Activeã®ã¿
  filter: 'statecode eq 0',
  
  // è¤‡æ•°æ¡ä»¶ï¼ˆANDï¼‰
  filter: 'statecode eq 0 and geek_priority eq 0',
  
  // è¤‡æ•°æ¡ä»¶ï¼ˆORï¼‰
  filter: 'geek_priority eq 0 or geek_priority eq 1',
  
  // éƒ¨åˆ†ä¸€è‡´æ¤œç´¢
  filter: "contains(geek_projectname, 'é–‹ç™º')"
};
```

#### orderByï¼ˆä¸¦ã³æ›¿ãˆï¼‰
```typescript
const options: IOperationOptions = {
  orderBy: ['createdon desc'], // ä½œæˆæ—¥æ™‚ã®é™é †
  orderBy: ['geek_priority asc', 'createdon desc'] // è¤‡æ•°æ¡ä»¶
};
```

#### topï¼ˆå–å¾—ä»¶æ•°åˆ¶é™ï¼‰
```typescript
const options: IOperationOptions = {
  top: 10 // æœ€æ–°10ä»¶ã®ã¿
};
```

#### expandï¼ˆLookupå±•é–‹ï¼‰
```typescript
const options: IOperationOptions = {
  select: ['geek_taskid', 'geek_taskname', '_geek_projectid_value'],
  expand: ['geek_projectid($select=geek_projectid,geek_projectname)']
};
```

---

### 4.3 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

```typescript
export async function fetchBusinessProcesses(): Promise<GeekBusinessProcess[]> {
  try {
    const client = getDataClient();
    const result = await client.retrieveMultipleRecordsAsync<GeekBusinessProcess>(
      TABLE_NAME,
      options
    );

    // æˆåŠŸåˆ¤å®š
    if (!result.success) {
      // ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ãƒ­ã‚°å‡ºåŠ›
      console.error('Dataverse API Error:', {
        message: result.error?.message,
        code: result.error?.code,
        details: result.error
      });
      
      throw new Error(`ãƒ‡ãƒ¼ã‚¿å–å¾—ã«å¤±æ•—: ${result.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`);
    }

    // ãƒ‡ãƒ¼ã‚¿ãŒç©ºã®å ´åˆã‚‚æ­£å¸¸
    return result.data || [];
    
  } catch (error) {
    console.error('Unexpected error in fetchBusinessProcesses:', error);
    throw error;
  }
}
```

---

## Step 5: UIã§ã®åˆ©ç”¨

### 5.1 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ

å†åˆ©ç”¨å¯èƒ½ãªã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®:**
```
src/
â””â”€â”€ hooks/
    â””â”€â”€ useBusinessProcesses.ts
```

**å®Ÿè£…ä¾‹:**
```typescript
import { useState, useEffect } from 'react';
import { usePowerPlatform } from '@microsoft/power-apps';
import { 
  fetchBusinessProcesses,
  createBusinessProcess,
  updateBusinessProcess,
  deleteBusinessProcess
} from '@/Services/GeekBusinessProcessService';
import type { GeekBusinessProcess } from '@/Models/GeekBusinessProcessModel';
import { toast } from 'sonner';

export function useBusinessProcesses() {
  const { isInitialized } = usePowerPlatform();
  const [processes, setProcesses] = useState<GeekBusinessProcess[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
  const loadProcesses = async () => {
    // SDKåˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯
    if (!isInitialized) {
      console.log('Power Apps SDK not initialized yet');
      return;
    }

    try {
      setLoading(true);
      setError(null);
      const data = await fetchBusinessProcesses();
      setProcesses(data);
    } catch (err) {
      const message = err instanceof Error ? err.message : 'ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼';
      setError(message);
      toast.error(message);
    } finally {
      setLoading(false);
    }
  };

  // SDKåˆæœŸåŒ–å¾Œã«è‡ªå‹•ãƒ­ãƒ¼ãƒ‰
  useEffect(() => {
    if (isInitialized) {
      loadProcesses();
    }
  }, [isInitialized]);

  // ä½œæˆ
  const create = async (input: GeekBusinessProcessCreateInput) => {
    try {
      const id = await createBusinessProcess(input);
      toast.success('ä½œæˆã—ã¾ã—ãŸ');
      await loadProcesses(); // å†èª­ã¿è¾¼ã¿
      return id;
    } catch (err) {
      const message = err instanceof Error ? err.message : 'ä½œæˆã‚¨ãƒ©ãƒ¼';
      toast.error(message);
      throw err;
    }
  };

  // æ›´æ–°
  const update = async (id: string, input: GeekBusinessProcessUpdateInput) => {
    try {
      await updateBusinessProcess(id, input);
      toast.success('æ›´æ–°ã—ã¾ã—ãŸ');
      await loadProcesses(); // å†èª­ã¿è¾¼ã¿
    } catch (err) {
      const message = err instanceof Error ? err.message : 'æ›´æ–°ã‚¨ãƒ©ãƒ¼';
      toast.error(message);
      throw err;
    }
  };

  // å‰Šé™¤
  const remove = async (id: string) => {
    try {
      await deleteBusinessProcess(id);
      toast.success('å‰Šé™¤ã—ã¾ã—ãŸ');
      await loadProcesses(); // å†èª­ã¿è¾¼ã¿
    } catch (err) {
      const message = err instanceof Error ? err.message : 'å‰Šé™¤ã‚¨ãƒ©ãƒ¼';
      toast.error(message);
      throw err;
    }
  };

  return {
    processes,
    loading,
    error,
    reload: loadProcesses,
    create,
    update,
    remove,
    isInitialized
  };
}
```

---

### 5.2 Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨

```typescript
import { useBusinessProcesses } from '@/hooks/useBusinessProcesses';
import { Button } from '@/components/ui/button';

export function ProcessList() {
  const { 
    processes, 
    loading, 
    error, 
    create, 
    update, 
    remove,
    isInitialized 
  } = useBusinessProcesses();

  // SDKæœªåˆæœŸåŒ–æ™‚
  if (!isInitialized) {
    return (
      <div className="flex items-center justify-center p-8">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
          <p className="mt-4 text-muted-foreground">Power Apps SDK åˆæœŸåŒ–ä¸­...</p>
        </div>
      </div>
    );
  }

  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­
  if (loading) {
    return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  }

  // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚
  if (error) {
    return (
      <div className="text-red-500">
        ã‚¨ãƒ©ãƒ¼: {error}
      </div>
    );
  }

  // ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
  return (
    <div>
      <h2>ãƒ—ãƒ­ã‚»ã‚¹ä¸€è¦§ ({processes.length}ä»¶)</h2>
      
      {processes.length === 0 ? (
        <p className="text-muted-foreground">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
      ) : (
        <ul>
          {processes.map((process) => (
            <li key={process.geek_businessprocessid}>
              {process.geek_processname}
              <Button 
                variant="destructive" 
                size="sm"
                onClick={() => remove(process.geek_businessprocessid!)}
              >
                å‰Šé™¤
              </Button>
            </li>
          ))}
        </ul>
      )}

      <Button onClick={() => create({ geek_processname: 'æ–°è¦ãƒ—ãƒ­ã‚»ã‚¹' })}>
        æ–°è¦ä½œæˆ
      </Button>
    </div>
  );
}
```

---

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼1: "The interface 'CDPTabular1' was not found"

**åŸå› :**  
`npx @microsoft/power-apps-cli add-data-source` ã§ `-a shared_commondataserviceforapps` ã‚’æŒ‡å®šã—ã¦ã„ã‚‹

**è§£æ±ºç­–:**
```bash
# âœ… æ­£ã—ã„ã‚³ãƒãƒ³ãƒ‰
npx @microsoft/power-apps-cli add-data-source -a dataverse -t <ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å>
```

---

### ã‚¨ãƒ©ãƒ¼2: "Data source not found: Failed to load Dataverse database references"

**åŸå› :**
- `dataSourcesInfo.ts` ã«ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ãŒå­˜åœ¨ã—ãªã„
- `power.config.json` ã®è¨­å®šãŒä¸æ­£

**è§£æ±ºç­–:**
1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’å†è¿½åŠ 
```bash
npx @microsoft/power-apps-cli add-data-source -a dataverse -t <ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å>
```

2. ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
```
.power/schemas/dataverse/<ãƒ†ãƒ¼ãƒ–ãƒ«å>.Schema.json
.power/schemas/appschemas/dataSourcesInfo.ts
```

---

### ã‚¨ãƒ©ãƒ¼3: "PowerDataRuntime is not initialized"

**åŸå› :**  
Power Apps SDK ã®åˆæœŸåŒ–å‰ã«Dataverse APIã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹

**è§£æ±ºç­–:**  
`usePowerPlatform().isInitialized` ã§åˆæœŸåŒ–å®Œäº†ã‚’å¾…ã¤

```typescript
const { isInitialized } = usePowerPlatform();

useEffect(() => {
  if (isInitialized) {
    loadData(); // SDKåˆæœŸåŒ–å®Œäº†å¾Œã«å®Ÿè¡Œ
  }
}, [isInitialized]);
```

---

### ã‚¨ãƒ©ãƒ¼4: "Content Security Policy directive" (CSPé•å)

**åŸå› :**  
`fetch` API ã‚’ç›´æ¥ä½¿ç”¨ã—ã¦ Dataverse ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹

**è§£æ±ºç­–:**  
Power Apps SDK (`@microsoft/power-apps/data`) ã‚’ä½¿ç”¨ã™ã‚‹

```typescript
// âŒ é¿ã‘ã‚‹
const response = await fetch(dataverseUrl);

// âœ… æ¨å¥¨
import { getClient } from '@microsoft/power-apps/data';
const client = getClient(dataSourcesInfo);
const result = await client.retrieveMultipleRecordsAsync(...);
```

---

### ã‚¨ãƒ©ãƒ¼5: ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„ï¼ˆ404ã‚¨ãƒ©ãƒ¼ï¼‰

**åŸå› :**  
ãƒ†ãƒ¼ãƒ–ãƒ«åï¼ˆEntitySetNameï¼‰ãŒé–“é•ã£ã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•:**
1. `power.config.json` ã® `dataSources` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª
2. `.power/schemas/dataverse/` ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèª
3. Service ã‚³ãƒ¼ãƒ‰ã® `TABLE_NAME` ã‚’ä¸Šè¨˜ã«åˆã‚ã›ã‚‹

```typescript
// dataSourcesInfo.ts ã® tableId ã¨ä¸€è‡´ã•ã›ã‚‹
const TABLE_NAME = 'geekbusinessprocesses'; // â† ã“ã“ãŒé‡è¦
```

---

### ã‚¨ãƒ©ãƒ¼6: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®ã‚¨ãƒ©ãƒ¼

**åŸå› :**  
Modelå®šç¾©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åãŒå®Ÿéš›ã®Dataverseã‚¹ã‚­ãƒ¼ãƒã¨ç•°ãªã‚‹

**è§£æ±ºç­–:**
1. `.power/schemas/dataverse/<ãƒ†ãƒ¼ãƒ–ãƒ«å>.Schema.json` ã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã‚’ç¢ºèª
2. Modelå®šç¾©ã‚’ä¿®æ­£ï¼ˆå¤§æ–‡å­—å°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã¾ã§æ­£ç¢ºã«ä¸€è‡´ã•ã›ã‚‹ï¼‰

```typescript
// âŒ é–“é•ã„
export interface GeekBusinessProcess {
  processName: string; // ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹
}

// âœ… æ­£ã—ã„
export interface GeekBusinessProcess {
  geek_processname: string; // ã‚¹ã‚­ãƒ¼ãƒã¨å®Œå…¨ä¸€è‡´
}
```

---

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ ã¯æ­£ã—ã„ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨

```bash
# âœ… æ¨å¥¨
npx @microsoft/power-apps-cli add-data-source -a dataverse -t <ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†å>

# âŒ éæ¨å¥¨
npx @microsoft/power-apps-cli add-data-source -a shared_commondataserviceforapps -c <æ¥ç¶šID>
```

**ç†ç”±:**
- ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹
- ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã«ãã„

---

### 2. Power Apps SDK ã‚’ä½¿ç”¨

```typescript
// âœ… æ¨å¥¨: Power Apps SDK
import { getClient } from '@microsoft/power-apps/data';
const client = getClient(dataSourcesInfo);

// âŒ éæ¨å¥¨: ç›´æ¥fetch
fetch(dataverseUrl)
```

**ç†ç”±:**
- CSPåˆ¶ç´„ã‚’å›é¿
- èªè¨¼ãŒè‡ªå‹•å‡¦ç†
- å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒçµ±ä¸€

---

### 3. SDKåˆæœŸåŒ–ã‚’å¿…ãšç¢ºèª

```typescript
const { isInitialized } = usePowerPlatform();

// âœ… æ¨å¥¨: åˆæœŸåŒ–å®Œäº†ã‚’å¾…ã¤
useEffect(() => {
  if (isInitialized) {
    loadData();
  }
}, [isInitialized]);

// âŒ éæ¨å¥¨: åˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯ãªã—
useEffect(() => {
  loadData(); // ã‚¨ãƒ©ãƒ¼ã®åŸå› 
}, []);
```

---

### 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…

```typescript
// âœ… æ¨å¥¨: result.success ã‚’ç¢ºèª
const result = await client.retrieveMultipleRecordsAsync(...);
if (!result.success) {
  console.error('Error:', result.error);
  throw new Error(result.error?.message || 'Unknown error');
}

// âŒ éæ¨å¥¨: ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ãªã—
const result = await client.retrieveMultipleRecordsAsync(...);
return result.data; // ã‚¨ãƒ©ãƒ¼æ™‚ã« undefined ãŒè¿”ã‚‹
```

---

### 5. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯ã‚¹ã‚­ãƒ¼ãƒã¨å®Œå…¨ä¸€è‡´

```typescript
// âœ… æ¨å¥¨: ã‚¹ã‚­ãƒ¼ãƒã¨å®Œå…¨ä¸€è‡´
export interface GeekBusinessProcess {
  geek_businessprocessid?: string;
  geek_processname: string;
}

// âŒ éæ¨å¥¨: ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹å¤‰æ›
export interface GeekBusinessProcess {
  id?: string;
  processName: string;
}
```

---

### 6. Serviceå±¤ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–

```typescript
// âœ… æ¨å¥¨: Serviceå±¤ã‚’ä½œæˆ
// GeekBusinessProcessService.ts
export async function fetchBusinessProcesses() { ... }

// UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
import { fetchBusinessProcesses } from '@/Services/GeekBusinessProcessService';

// âŒ éæ¨å¥¨: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç›´æ¥å‘¼ã³å‡ºã—
const client = getClient(dataSourcesInfo);
const result = await client.retrieveMultipleRecordsAsync(...);
```

---

### 7. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§å†åˆ©ç”¨æ€§ã‚’å‘ä¸Š

```typescript
// âœ… æ¨å¥¨: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
export function useBusinessProcesses() {
  // ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–
  return { processes, loading, error, create, update, remove };
}

// è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å†åˆ©ç”¨
const { processes } = useBusinessProcesses();
```

---

## âœ… å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å®Ÿè£…ãŒå®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

### ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¿½åŠ 
- [ ] `npx @microsoft/power-apps-cli add-data-source -a dataverse -t <è«–ç†å>` ã‚’å®Ÿè¡Œæ¸ˆã¿
- [ ] `.power/schemas/dataverse/` ã«ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `.power/schemas/appschemas/dataSourcesInfo.ts` ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- [ ] `power.config.json` ã® `databaseReferences` ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹

### Modelå®šç¾©
- [ ] Modelå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`src/Models/`ï¼‰ã‚’ä½œæˆ
- [ ] ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åãŒã‚¹ã‚­ãƒ¼ãƒã¨å®Œå…¨ä¸€è‡´
- [ ] å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’åŒºåˆ¥
- [ ] Create/Updateç”¨ã®å‹ã‚’å®šç¾©

### Serviceå®Ÿè£…
- [ ] Serviceå±¤ï¼ˆ`src/Services/`ï¼‰ã‚’å®Ÿè£…
- [ ] `TABLE_NAME` ãŒ `dataSourcesInfo.ts` ã® `tableId` ã¨ä¸€è‡´
- [ ] Power Apps SDK (`getClient`) ã‚’ä½¿ç”¨
- [ ] `result.success` ã§ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…
- [ ] é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨­å®š

### UIçµ±åˆ
- [ ] ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼ˆ`src/hooks/`ï¼‰ã‚’å®Ÿè£…
- [ ] `usePowerPlatform().isInitialized` ã§åˆæœŸåŒ–ç¢ºèª
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®è¡¨ç¤º
- [ ] ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®è¡¨ç¤º
- [ ] CRUDæ“ä½œãŒæ­£å¸¸ã«å‹•ä½œ

### ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆ`npm run dev`ï¼‰ã§å‹•ä½œç¢ºèª
- [ ] Power Appsç’°å¢ƒï¼ˆ`npx @microsoft/power-apps-cli init` + `npm run dev`ï¼‰ã§å‹•ä½œç¢ºèª
- [ ] ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãŒæˆåŠŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚ŠãŒæˆåŠŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãŒæˆåŠŸ
- [ ] ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ãŒæˆåŠŸ

### ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] `npm run build` ã§ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- [ ] `npx @microsoft/power-apps-cli push` ã§ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸ
- [ ] Power Appsç’°å¢ƒã§ã‚¢ãƒ—ãƒªãŒèµ·å‹•
- [ ] å®Ÿãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤º

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Power Platform CLI - add-data-source ã‚³ãƒãƒ³ãƒ‰](https://learn.microsoft.com/en-us/power-platform/developer/cli/reference/code#pac-code-add-data-source)
- [Power Apps SDK - Data ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](https://learn.microsoft.com/en-us/power-apps/developer/model-driven-apps/clientapi/reference)
- [Dataverse Web API Reference](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/webapi/overview)
- [OData Query Options](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/webapi/query-data-web-api)
- [Power Apps Code Apps æ¦‚è¦](https://learn.microsoft.com/en-us/power-apps/maker/canvas-apps/code-apps/overview)

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [CodeAppsDevelopmentStandard](https://github.com/geekfujiwara/CodeAppsDevelopmentStandard)
- [DATAVERSE_INTEGRATION_BEST_PRACTICES.md](./DATAVERSE_INTEGRATION_BEST_PRACTICES.md) - è©³ç´°ãªãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- [HOW_TO_GET_DATAVERSE_SCHEMA.md](./HOW_TO_GET_DATAVERSE_SCHEMA.md) - ã‚¹ã‚­ãƒ¼ãƒå–å¾—æ–¹æ³•
- [DATAVERSE_TROUBLESHOOTING.md](./DATAVERSE_TROUBLESHOOTING.md) - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- [LOOKUP_FIELD_GUIDE.md](./LOOKUP_FIELD_GUIDE.md) - Lookupãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®Ÿè£…ã‚¬ã‚¤ãƒ‰

---

## ğŸ“ ã¾ã¨ã‚

### é‡è¦ãƒã‚¤ãƒ³ãƒˆ

1. **âœ… `npx @microsoft/power-apps-cli add-data-source -a dataverse` ã‚’ä½¿ç”¨**
   - ãƒ†ãƒ¼ãƒ–ãƒ«è«–ç†åï¼ˆå˜æ•°å½¢ï¼‰ã®ã¿æŒ‡å®š
   - ã‚¹ã‚­ãƒ¼ãƒã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹

2. **âœ… Power Apps SDK ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹**
   - CSPåˆ¶ç´„ã‚’å›é¿
   - å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
   - è‡ªå‹•èªè¨¼å‡¦ç†

3. **âœ… SDKåˆæœŸåŒ–ã‚’å¿…ãšç¢ºèª**
   - `usePowerPlatform().isInitialized` ã§ç¢ºèª
   - åˆæœŸåŒ–å®Œäº†å¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹

4. **âœ… ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯ã‚¹ã‚­ãƒ¼ãƒã¨å®Œå…¨ä¸€è‡´**
   - `.power/schemas/dataverse/` ã§ç¢ºèª
   - å¤§æ–‡å­—å°æ–‡å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã¾ã§æ­£ç¢ºã«

5. **âœ… Serviceå±¤ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–**
   - å†åˆ©ç”¨å¯èƒ½ãªè¨­è¨ˆ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€

### æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

- â±ï¸ **é–‹ç™ºæ™‚é–“ã®å¤§å¹…çŸ­ç¸®**: æ­£ã—ã„ã‚³ãƒãƒ³ãƒ‰ã§ä¸€ç™ºã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆ
- ğŸ› **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚é–“å‰Šæ¸›**: CSPã‚¨ãƒ©ãƒ¼ã‚„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ä¸ä¸€è‡´ã‚’å›é¿
- ğŸ“ **ã‚³ãƒ¼ãƒ‰ã®ä¸€è²«æ€§**: Power Apps SDKã«ã‚ˆã‚‹çµ±ä¸€ã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
- ğŸ”’ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: è‡ªå‹•èªè¨¼å‡¦ç†ã«ã‚ˆã‚Šå®‰å…¨ãªã‚¢ã‚¯ã‚»ã‚¹
- ğŸš€ **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: æ¨™æº–ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚å®¹æ˜“ã«å¯¾å¿œ

---

**æœ€çµ‚æ›´æ–°**: 2026å¹´2æœˆ5æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**ä½œæˆè€…**: Dataverseæ¥ç¶šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçµ±åˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦ã®è³ªå•ã‚„æ”¹å–„ææ¡ˆã¯ã€GitHubã®Issueã§ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚

---
